<%- include("../partials/header-journal") %>

  <!-- CONTENT -->
  <div class="mt-3 mx-4">
    <section id="journal">
      <div class="container">
        <h2>Diario</h2>
        <div class="row mb-4">

          <!-- ENTRIES -->
          <div class="col-6">
            <div class="journal-box px-0">
              <div class="d-flex justify-content-between mx-3 mb-0">
                <a href="/<%= currentUser.username %>/journal/entry">
                  <h3>Últimas entradas</h3>
                </a>
                <div>
                  <img class="info" src="/imgs/icons/info.svg" data-toggle="tooltip" data-placement="top" title="Sección de las entradas de dirario">
                </div>
              </div>
              <hr class="mb-2">
              <div class="mx-3">
                <% entries.title.forEach((entry, i) => { %>
                  <a class="journal-link" href="/<%= currentUser.username %>/journal/entry/<%= entries.id[i] %>"><%= entry %></a>
                <% }); %>
              </div>
              <br>
              <h3 class="mx-3 mb-2">Crear una entrada</h3>
              <hr class="mb-2">
              <form class="d-flex flex-column" action="/<%= currentUser.username %>/journal/entry/new">
                <div class="d-flex justify-content-between align-items-center mb-3 mx-3">
                  <select id="entry-pair" class="custom-select p-1 w-50" onchange="entryPair();">
                    <!-- FIXME: passing the PAIR id is probably off by 1 -->
                    <% for (var i = 0; i < pairs.length; i++) { %>
                      <option value="<%= i %>"><%= pairs[i] %></option>
                    <% } %>
                  </select>
                  <div class="mx-auto my-2">
                    <div class="form-check form-check-inline">
                      <label class="checkbox-orange mb-0" id="double-top">
                        Compra
                        <input type="radio" name="direction" onclick="entryDirection(1);">
                        <span class="checkmark"></span>
                      </label>
                    </div>
                    <div class="form-check form-check-inline">
                      <label class="checkbox-orange mb-0" id="double-top">
                        Venta
                        <input type="radio" name="direction" onclick="entryDirection(-1);">
                        <span class="checkmark"></span>
                      </label>
                    </div>
                  </div>
                </div>
                <div class="d-flex justify-content-center mx-3">
                  <input type="submit" value="Continuar" class="btn-neilit">
                </div>
              </form>
            </div>
          </div>

          <!-- TECHNICAL ANALYSIS -->
          <div class="col-6">
            <div class="journal-box px-0">
              <div class="d-flex justify-content-between mx-3 mb-0">
                <a href="/username/journal/ta">
                  <h3>Análisis técnico</h3>
                </a>
                <div>
                  <img class="info" src="/imgs/icons/info.svg" data-toggle="tooltip" data-placement="top" title="Sección de las análisis técnicos">
                </div>
              </div>
              <hr class="mb-2">
              <div class="mx-3">
                <% tas.title.forEach((ta, i) => { %>
                  <a class="journal-link" href="/<%= currentUser.username %>/journal/ta/<%= tas.id[i] %>"><%= ta %></a>
                <% }); %>
              </div>
              <br>
              <h3 class="mx-3 mb-2">Nuevo análisis técnico</h3>
              <hr class="mb-3">
              <div class="mx-3">
                <form class="d-flex justify-content-between" action="/<%= currentUser.username %>/journal/ta/new">
                  <select id="ta-pair" class="custom-select p-1 w-50" onchange="taPair();">
                    <!-- FIXME: passing the PAIR id is probably off by 1 -->
                    <% for (var i = 0; i < pairs.length; i++) { %>
                      <option value="<%= i %>"><%= pairs[i] %></option>
                    <% } %>
                  </select>
                  <input type="submit" value="Continuar" class="btn-neilit">
                </form>
              </div>
            </div>
          </div>

        </div>

        <div class="row mb-4">
          <!-- COMMENTS -->
          <div class="col-6">
            <div class="journal-box px-0">
              <div class="d-flex justify-content-between mx-3 mb-0">
                <a href="/<%= currentUser.username %>/journal/comment">
                  <h3>Últimos comentarios</h3>
                </a>
                <div>
                  <img class="info" src="/imgs/icons/info.svg" data-toggle="tooltip" data-placement="top" title="Sección de comentarios">
                </div>
              </div>
              <hr class="mb-2">
              <div class="mx-3">
                <table class="w-100">
                  <% comments.date.forEach((date, index) => { %>
                    <tr>
                      <td><a class="journal-link" href="/<%= currentUser.username %>/journal/comment/<%= comments.id[index] %>"><%- comments.content[index] %></a></td>
                      <td class="comment-date"><%= date %></td>
                    </tr>
                  <% }) %>
                </table>
              </div>
              <br>
              <form class="d-flex justify-content-center mx-3" action="/<%= currentUser.username %>/journal/comment/new">
                <input type="submit" class="btn-neilit mx-2" value="Continuar">
                <input type="button" class="btn-inverted mx-2" value="Saber más">
              </form>
            </div>
          </div>

          <!-- BACKTESTING -->
          <div class="col-6">
            <div class="journal-box px-0">
              <div class="d-flex justify-content-between mx-3 mb-0">
                <a href="/username/journal/entry">
                  <h3>Backtesting</h3>
                </a>
                <div>
                  <img class="info" src="/imgs/icons/info.svg" data-toggle="tooltip" data-placement="top" title="Sección de 'backtesting' de estrategias">
                </div>
              </div>
              <hr class="mb-2">
              <div class="mx-3">
                <% if (backtest.title.length < 1) { %>
                  <p>Conoce el comportamiento de los activos y pon a prueba tus estrategias.</p>
                <% } else { %>
                  <% backtest.title.forEach((test, i) => { %>
                    <a class="journal-link" href="/<%= currentUser.username %>/journal/backtest/<%= backtest.id[i] %>"><%= test %></a>
                  <% }); %>
                <% } %>
              </div>
              <br>
              <form class="d-flex justify-content-center mx-3" action="/<%= currentUser.username %>/journal/backtest/new">
                <input type="submit" class="btn-neilit" value="Continuar">
                <input type="button" class="btn-inverted mx-2" value="Ver todo">
              </form>
            </div>
          </div>
        </div>

      </div>
    </section>

  </div>

<!-- <section> is inside partials -->
</section>

<%- include("../partials/footer-journal") %>
